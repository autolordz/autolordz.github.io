<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="A Place for Learning">
<meta property="og:type" content="website">
<meta property="og:title" content="PinkyLand">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="PinkyLand">
<meta property="og:description" content="A Place for Learning">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PinkyLand">
<meta name="twitter:description" content="A Place for Learning">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":true,"scrollpercent":true,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>PinkyLand</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">PinkyLand</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">PinkyLand Always</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            Sitemap
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/23/course7project/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Auto Zhao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars1.githubusercontent.com/u/7811828?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="PinkyLand">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/23/course7project/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-23T18:07:59+08:00">
                2018-03-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Course 7 Project : Is Manual Transmission more Fuel-efficient than</p>
<h1 id="Automatic-Transmission"><a href="#Automatic-Transmission" class="headerlink" title="Automatic Transmission?"></a>Automatic Transmission?</h1><p>Autoz<br>2017.12.20</p>
<h1 id="Synopsis"><a href="#Synopsis" class="headerlink" title="Synopsis"></a>Synopsis</h1><p>This Study is about Regression Models Course Project.We use data of<br>Motor Trend which is they are interested in exploring the relationship<br>between a set of variables and miles per gallon (MPG) (outcome). Here’s<br>the missions:</p>
<ul>
<li>“Is an automatic or manual transmission better for MPG”</li>
<li>“Quantify the MPG difference between automatic and manual<br>transmissions”</li>
</ul>
<p>About Data: mtcars which shows the relationships between automatic and<br>manual by different transmission.</p>
<ul>
<li>mpg Miles/(US) gallon</li>
<li>cyl Number of cylinders</li>
<li>disp Displacement (cu.in.)</li>
<li>hp Gross horsepower</li>
<li>drat Rear axle ratio</li>
<li>wt Weight (1000 lbs)</li>
<li>qsec 1/4 mile time</li>
<li>vs V/S</li>
<li>am Transmission (0 = automatic, 1 = manual)</li>
<li>gear Number of forward gears</li>
<li>carb Number of carburetors</li>
</ul>
<h1 id="Reading-MTCARS-Data"><a href="#Reading-MTCARS-Data" class="headerlink" title="Reading MTCARS Data"></a>Reading MTCARS Data</h1><p>Prepare Environment.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(ggplot2)</span><br><span class="line"><span class="keyword">library</span>(dplyr)</span><br></pre></td></tr></table></figure>
<p>Look at the Data Structure.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data(mtcars)</span><br><span class="line">head(mtcars,<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<pre><code>##                mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4     21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710    22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
</code></pre><h1 id="Cleaning-The-Training-Data"><a href="#Cleaning-The-Training-Data" class="headerlink" title="Cleaning The Training Data"></a>Cleaning The Training Data</h1><p>At first, we need to change numerics into factors in order to fit the<br>model correctly.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mtcars$am &lt;- factor(mtcars$am,labels = c(<span class="string">"Automatic"</span>, <span class="string">"Manual"</span>))</span><br><span class="line">mtcars$gear = factor(mtcars$gear)</span><br><span class="line">mtcars$cyl  = factor(mtcars$cyl)</span><br><span class="line">mtcars$carb = factor(mtcars$carb)</span><br><span class="line">mtcars$vs   = factor(mtcars$vs)</span><br></pre></td></tr></table></figure>
<h1 id="Exploratory-Data-Analysis"><a href="#Exploratory-Data-Analysis" class="headerlink" title="Exploratory Data Analysis"></a>Exploratory Data Analysis</h1><p>As quiz 1 said “Is an automatic or manual transmission better for MPG”<br>.So first look at the assuming relationship between miles per gallon and<br>trasmissons types : mpg ~ am.</p>
<p><img src="course7project_files/figure-gfm/unnamed-chunk-4-1.png" alt=""><!-- --></p>
<p>As we can see maual cars will contribute more miles per gallon than<br>automatic cars.</p>
<h1 id="Learning-H0-Model"><a href="#Learning-H0-Model" class="headerlink" title="Learning H0 Model"></a>Learning H0 Model</h1><p>Assuming relationship “manal is better” is null hypothesis</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fit_H0 &lt;- lm(mpg ~ am, data = mtcars)</span><br><span class="line">summary(fit_H0)</span><br></pre></td></tr></table></figure>
<pre><code>## 
## Call:
## lm(formula = mpg ~ am, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.3923 -3.0923 -0.2974  3.2439  9.5077 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   17.147      1.125  15.247 1.13e-15 ***
## amManual       7.245      1.764   4.106 0.000285 ***
## ---
## Signif. codes:  0 &apos;***&apos; 0.001 &apos;**&apos; 0.01 &apos;*&apos; 0.05 &apos;.&apos; 0.1 &apos; &apos; 1
## 
## Residual standard error: 4.902 on 30 degrees of freedom
## Multiple R-squared:  0.3598, Adjusted R-squared:  0.3385 
## F-statistic: 16.86 on 1 and 30 DF,  p-value: 0.000285
</code></pre><p>As we can see above , H0 model’s Pr(>|t|) is very significant. But the<br>R-squared is just 0.3598, not enough to interpret all the variances<br>informations and only interpret 36% information.</p>
<h1 id="Reselected-Model"><a href="#Reselected-Model" class="headerlink" title="Reselected Model"></a>Reselected Model</h1><p>we use stepwise to choose our new fit model.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summary(step(lm(data = mtcars, mpg ~ .),trace = <span class="number">0</span>,direction=<span class="string">"both"</span>))</span><br></pre></td></tr></table></figure>
<pre><code>## 
## Call:
## lm(formula = mpg ~ cyl + hp + wt + am, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.9387 -1.2560 -0.4013  1.1253  5.0513 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 33.70832    2.60489  12.940 7.73e-13 ***
## cyl6        -3.03134    1.40728  -2.154  0.04068 *  
## cyl8        -2.16368    2.28425  -0.947  0.35225    
## hp          -0.03211    0.01369  -2.345  0.02693 *  
## wt          -2.49683    0.88559  -2.819  0.00908 ** 
## amManual     1.80921    1.39630   1.296  0.20646    
## ---
## Signif. codes:  0 &apos;***&apos; 0.001 &apos;**&apos; 0.01 &apos;*&apos; 0.05 &apos;.&apos; 0.1 &apos; &apos; 1
## 
## Residual standard error: 2.41 on 26 degrees of freedom
## Multiple R-squared:  0.8659, Adjusted R-squared:  0.8401 
## F-statistic: 33.57 on 5 and 26 DF,  p-value: 1.506e-10
</code></pre><p>Now we can see the R-squared is 0.8659. It interpreted almost 87%<br>variances. So we temporarily choose this model for our analysis.</p>
<p>We can get new fit model : <strong>mpg ~ cyl + hp + wt + am</strong>. Let’s re-order<br>those variables in formula.</p>
<h1 id="Model-Evaluation"><a href="#Model-Evaluation" class="headerlink" title="Model Evaluation"></a>Model Evaluation</h1><p>Let’s valid the chosen model. This model is nested model. We can use<br>function anova to analyse all of them</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fit0 &lt;- lm(data = mtcars, mpg ~ am)</span><br><span class="line">fit1 &lt;- lm(data = mtcars, mpg ~ am + hp)</span><br><span class="line">fit2 &lt;- lm(data = mtcars, mpg ~ am + hp + wt)</span><br><span class="line">fit3 &lt;- lm(data = mtcars, mpg ~ am + hp + wt + cyl)</span><br><span class="line">anova(fit0,fit1,fit2,fit3)</span><br></pre></td></tr></table></figure>
<pre><code>## Analysis of Variance Table
## 
## Model 1: mpg ~ am
## Model 2: mpg ~ am + hp
## Model 3: mpg ~ am + hp + wt
## Model 4: mpg ~ am + hp + wt + cyl
##   Res.Df    RSS Df Sum of Sq       F    Pr(&gt;F)    
## 1     30 720.90                                   
## 2     29 245.44  1    475.46 81.8529 1.634e-09 ***
## 3     28 180.29  1     65.15 11.2157  0.002484 ** 
## 4     26 151.03  2     29.27  2.5191  0.099998 .  
## ---
## Signif. codes:  0 &apos;***&apos; 0.001 &apos;**&apos; 0.01 &apos;*&apos; 0.05 &apos;.&apos; 0.1 &apos; &apos; 1
</code></pre><p>We can see those models <code>RSS</code> is from 721 to 151. But we just only<br>interesting in Model 1 and Model 4. Now we focus the last Model 4</p>
<h1 id="Another-Model"><a href="#Another-Model" class="headerlink" title="Another Model"></a>Another Model</h1><p>As we can see, we disregard variable cylinder <code>cyl</code> and see what<br>happened.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summary(step(lm(data = mtcars, mpg ~ . - cyl),trace = <span class="number">0</span>,direction=<span class="string">"both"</span>))</span><br></pre></td></tr></table></figure>
<pre><code>## 
## Call:
## lm(formula = mpg ~ wt + qsec + am, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4811 -1.5555 -0.7257  1.4110  4.6610 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   9.6178     6.9596   1.382 0.177915    
## wt           -3.9165     0.7112  -5.507 6.95e-06 ***
## qsec          1.2259     0.2887   4.247 0.000216 ***
## amManual      2.9358     1.4109   2.081 0.046716 *  
## ---
## Signif. codes:  0 &apos;***&apos; 0.001 &apos;**&apos; 0.01 &apos;*&apos; 0.05 &apos;.&apos; 0.1 &apos; &apos; 1
## 
## Residual standard error: 2.459 on 28 degrees of freedom
## Multiple R-squared:  0.8497, Adjusted R-squared:  0.8336 
## F-statistic: 52.75 on 3 and 28 DF,  p-value: 1.21e-11
</code></pre><p>As you can see R-squared is 0.8497. Maybe <strong>mpg ~ wt + qsec + am</strong><br>included <code>qsec</code> is a good model, but wait.</p>
<p>The <code>am</code> variables seems merely significant, that means we are not sure<br>whether the model is good enough.</p>
<p>Now We can compare fit0 and fit4.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fit4 &lt;- lm(data = mtcars, mpg ~ wt + qsec + am)</span><br><span class="line">anova(fit0,fit4)</span><br></pre></td></tr></table></figure>
<pre><code>## Analysis of Variance Table
## 
## Model 1: mpg ~ am
## Model 2: mpg ~ wt + qsec + am
##   Res.Df    RSS Df Sum of Sq      F   Pr(&gt;F)    
## 1     30 720.90                                 
## 2     28 169.29  2    551.61 45.618 1.55e-09 ***
## ---
## Signif. codes:  0 &apos;***&apos; 0.001 &apos;**&apos; 0.01 &apos;*&apos; 0.05 &apos;.&apos; 0.1 &apos; &apos; 1
</code></pre><p>As comparing RSS and Pr(>F) of fit3 and fit4, finally we choose fit3.</p>
<h1 id="Final-Selected-Model"><a href="#Final-Selected-Model" class="headerlink" title="Final Selected Model"></a>Final Selected Model</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">par(mfrow = c(<span class="number">2</span>,<span class="number">2</span>))</span><br><span class="line">plot(fit3)</span><br></pre></td></tr></table></figure>
<p><img src="course7project_files/figure-gfm/unnamed-chunk-10-1.png" alt=""><!-- --></p>
<p>As we can see , residuals center , normal QQ fit normal</p>
<p>So the final model’s coeficient is:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fitfinal &lt;- lm(data = mtcars, mpg ~ am + hp + wt + cyl - <span class="number">1</span>)</span><br><span class="line">summary(fitfinal)$coef</span><br></pre></td></tr></table></figure>
<pre><code>##                Estimate Std. Error   t value     Pr(&gt;|t|)
## amAutomatic 33.70832390 2.60488618 12.940421 7.733392e-13
## amManual    35.51753528 2.03171034 17.481594 6.811749e-16
## hp          -0.03210943 0.01369257 -2.345025 2.693461e-02
## wt          -2.49682942 0.88558779 -2.819404 9.081408e-03
## cyl6        -3.03134449 1.40728351 -2.154040 4.068272e-02
## cyl8        -2.16367532 2.28425172 -0.947214 3.522509e-01
</code></pre><h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>As other factors are constants. Every automatic car will increase <code>33.8</code><br>miles per gallon while manual car increase <code>35.5</code> miles per gallon. No<br>matter what, <code>manual can drive more mile than automatic when amount of
fuel is the same</code>.</p>
<h1 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix"></a>Appendix</h1><p>Plots about the relationships of variables in <code>Final Model</code>. To answer<br>the Quiz 2 “Quantify the MPG difference between automatic and manual<br>transmissions”</p>
<ul>
<li>MPG vs. Weight by Transmissions Types</li>
</ul>
<p><img src="course7project_files/figure-gfm/unnamed-chunk-12-1.png" alt=""><!-- --></p>
<ul>
<li>MPG vs. Horsepower by Transmissions Types</li>
</ul>
<p><img src="course7project_files/figure-gfm/unnamed-chunk-13-1.png" alt=""><!-- --></p>
<ul>
<li>MPG vs. 1/4 Miles Time by Transmissions Types</li>
</ul>
<p><img src="course7project_files/figure-gfm/unnamed-chunk-14-1.png" alt=""><!-- --></p>
<ul>
<li>MPG vs. All Selected Factors by Transmissions Types</li>
</ul>
<p><img src="course7project_files/figure-gfm/unnamed-chunk-15-1.png" alt=""><!-- --></p>
<ul>
<li>So you can see it is very clear for answer the questions.</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/09/courseProject - 副本/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Auto Zhao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars1.githubusercontent.com/u/7811828?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="PinkyLand">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/09/courseProject - 副本/" itemprop="url">Couse 8 Project Quantified Self Movement</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-09T00:00:00+08:00">
                2018-01-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Synopsis"><a href="#Synopsis" class="headerlink" title="Synopsis"></a>Synopsis</h1><p>One thing that people regularly do is quantify how much of a particular activity they do,but they rarely quantify how well they do it. In this project, your goal will be to use data from accelerometers on the belt, forearm, arm, and dumbell of 6 participants. With Following Steps:</p>
<ul>
<li>1 fit model</li>
<li>2 cross validation</li>
<li>3 sample errors</li>
<li>4 make choices</li>
<li>5 predict 20 test case</li>
</ul>
<h1 id="Read-PML-Data"><a href="#Read-PML-Data" class="headerlink" title="Read PML Data"></a>Read PML Data</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(tidyverse)</span><br><span class="line">training_raw &lt;- read_csv(<span class="string">"pml-training.csv"</span>,na = c(<span class="string">"NA"</span>,<span class="string">"#DIV/0!"</span>,<span class="string">""</span>))</span><br><span class="line">testing_raw &lt;- read_csv(<span class="string">"pml-testing.csv"</span>,na = c(<span class="string">"NA"</span>,<span class="string">"#DIV/0!"</span>,<span class="string">""</span>))</span><br><span class="line">training_raw &lt;- as.data.frame(training_raw)</span><br><span class="line">testing_raw &lt;- as.data.frame(testing_raw)</span><br></pre></td></tr></table></figure>
<h1 id="Cleaning-the-Training-Data"><a href="#Cleaning-the-Training-Data" class="headerlink" title="Cleaning the Training Data"></a>Cleaning the Training Data</h1><h2 id="Factorized-classes"><a href="#Factorized-classes" class="headerlink" title="Factorized classes"></a>Factorized classes</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">training_raw$classe &lt;- factor(training_raw$classe)</span><br></pre></td></tr></table></figure>
<h2 id="Remove-columns-with-more-than-70-of-NA-or-“”-values"><a href="#Remove-columns-with-more-than-70-of-NA-or-“”-values" class="headerlink" title="Remove columns with more than 70% of NA or “” values"></a>Remove columns with more than 70% of NA or “” values</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">NArate &lt;- <span class="keyword">function</span>(x)&#123;</span><br><span class="line">    apply(x, <span class="number">2</span>, <span class="keyword">function</span>(y) sum(is.na(y)))/nrow(x)</span><br><span class="line">&#125;</span><br><span class="line">training_raw &lt;- training_raw[,NArate(training_raw) &lt; <span class="number">.7</span>]</span><br></pre></td></tr></table></figure>
<h2 id="Remove-near-zero-variances"><a href="#Remove-near-zero-variances" class="headerlink" title="Remove near zero variances"></a>Remove near zero variances</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(caret)</span><br><span class="line">nzvCol &lt;- nearZeroVar(training_raw, saveMetrics = <span class="literal">TRUE</span>)</span><br><span class="line">training_raw &lt;- training_raw[, !nzvCol$nzv]</span><br></pre></td></tr></table></figure>
<h2 id="Remove-unused-variables"><a href="#Remove-unused-variables" class="headerlink" title="Remove unused variables"></a>Remove unused variables</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">training_raw &lt;- training_raw[,-grep(<span class="string">"name|timestamp|window|^X"</span>,names(training_raw))]</span><br></pre></td></tr></table></figure>
<h2 id="Impute-all-NAs"><a href="#Impute-all-NAs" class="headerlink" title="Impute all NAs"></a>Impute all NAs</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(mice)</span><br><span class="line">imp &lt;- mice(training_raw,seed = <span class="number">3</span>)</span><br><span class="line">training_raw &lt;- mice::complete(imp)</span><br></pre></td></tr></table></figure>
<h2 id="Remove-75-highly-Correlative-Variables"><a href="#Remove-75-highly-Correlative-Variables" class="headerlink" title="Remove 75% highly Correlative Variables"></a>Remove 75% highly Correlative Variables</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">trainingNC &lt;- training_raw[, -length(names(training_raw))]</span><br><span class="line"></span><br><span class="line">findcor &lt;- findCorrelation(cor(trainingNC,use=<span class="string">"complete.obs"</span>), cutoff = <span class="number">.75</span>)</span><br><span class="line"></span><br><span class="line">trainingFiltered &lt;- training_raw[,-findcor]</span><br><span class="line">trainingFilteredNC &lt;- trainingNC[,-findcor]</span><br></pre></td></tr></table></figure>
<h2 id="Split-data-into-Training-and-Testing-sets"><a href="#Split-data-into-Training-and-Testing-sets" class="headerlink" title="Split data into Training and Testing sets"></a>Split data into Training and Testing sets</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">inTrain &lt;- createDataPartition(y = trainingFiltered$classe, p = <span class="number">0.75</span>, </span><br><span class="line">                               list = <span class="literal">FALSE</span>) <span class="comment"># 75% training</span></span><br><span class="line">training &lt;- trainingFiltered[inTrain,]</span><br><span class="line">testing &lt;- trainingFiltered[-inTrain,]</span><br></pre></td></tr></table></figure>
<h1 id="Model-Evaluation"><a href="#Model-Evaluation" class="headerlink" title="Model Evaluation"></a>Model Evaluation</h1><h2 id="Decision-Tree"><a href="#Decision-Tree" class="headerlink" title="Decision Tree"></a>Decision Tree</h2><p>Time Used</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(rpart)</span><br><span class="line">system.time(mod_rpart &lt;- rpart(formula = classe ~ ., data = training))</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#    user  system elapsed </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#    1.75    0.00    1.78</span></span></span><br></pre></td></tr></table></figure>
<p>Training Rpart Model</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">predict_rpart &lt;- predict(mod_rpart,newdata = testing,</span><br><span class="line">                         type = <span class="string">"class"</span>)</span><br><span class="line">confusionMatrix(predict_rpart,testing$classe)</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Confusion Matrix and Statistics</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#           Reference</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Prediction    A    B    C    D    E</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          A 1175  172   47   70   33</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          B   77  528  123   48  111</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          C   61  154  610  192  162</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          D   49   80   36  434   66</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          E   33   15   39   60  529</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Overall Statistics</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                                           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                Accuracy : 0.668           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                  95% CI : (0.6546, 0.6812)</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     No Information Rate : 0.2845          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                                           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                   Kappa : 0.5791          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#  Mcnemar's Test P-Value : &lt; 2.2e-16       </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Statistics by Class:</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                      Class: A Class: B Class: C Class: D Class: E</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Sensitivity            0.8423   0.5564   0.7135   0.5398   0.5871</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Specificity            0.9082   0.9092   0.8595   0.9437   0.9633</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Pos Pred Value         0.7849   0.5953   0.5174   0.6526   0.7825</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Neg Pred Value         0.9354   0.8952   0.9342   0.9127   0.9120</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Prevalence             0.2845   0.1935   0.1743   0.1639   0.1837</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Detection Rate         0.2396   0.1077   0.1244   0.0885   0.1079</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Detection Prevalence   0.3053   0.1809   0.2404   0.1356   0.1378</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Balanced Accuracy      0.8753   0.7328   0.7865   0.7417   0.7752</span></span></span><br></pre></td></tr></table></figure>
<h2 id="C50-Tree"><a href="#C50-Tree" class="headerlink" title="C50 Tree"></a>C50 Tree</h2><p>Same processing</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(C50)</span><br><span class="line">system.time(mod_C50 &lt;- C5.0(formula = classe ~ ., data = training))</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#    user  system elapsed </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#    2.25    0.00    2.25</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">predict_C50 &lt;- predict(mod_C50,newdata = testing)</span><br><span class="line">confusionMatrix(predict_C50,testing$classe)</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Confusion Matrix and Statistics</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#           Reference</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Prediction    A    B    C    D    E</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          A 1370   23    5    8    2</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          B   11  890   22   12   20</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          C    6   23  800   24    5</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          D    6   10   22  751    8</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          E    2    3    6    9  866</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Overall Statistics</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                                           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                Accuracy : 0.9537          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                  95% CI : (0.9475, 0.9594)</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     No Information Rate : 0.2845          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     P-Value [Acc &gt; NIR] : &lt; 2e-16         </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                                           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                   Kappa : 0.9414          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#  Mcnemar's Test P-Value : 0.06176         </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Statistics by Class:</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                      Class: A Class: B Class: C Class: D Class: E</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Sensitivity            0.9821   0.9378   0.9357   0.9341   0.9612</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Specificity            0.9892   0.9836   0.9857   0.9888   0.9950</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Pos Pred Value         0.9730   0.9319   0.9324   0.9423   0.9774</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Neg Pred Value         0.9928   0.9851   0.9864   0.9871   0.9913</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Prevalence             0.2845   0.1935   0.1743   0.1639   0.1837</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Detection Rate         0.2794   0.1815   0.1631   0.1531   0.1766</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Detection Prevalence   0.2871   0.1947   0.1750   0.1625   0.1807</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Balanced Accuracy      0.9856   0.9607   0.9607   0.9614   0.9781</span></span></span><br></pre></td></tr></table></figure>
<h2 id="SVM"><a href="#SVM" class="headerlink" title="SVM"></a>SVM</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(kernlab)</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Attaching package: 'kernlab'</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># The following object is masked from 'package:purrr':</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     cross</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># The following object is masked from 'package:ggplot2':</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     alpha</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(e1071)</span><br><span class="line">system.time(mod_svm &lt;- svm(formula = classe ~ ., data = training,</span><br><span class="line">                           kernel = <span class="string">"linear"</span>,cost = <span class="number">10</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#    user  system elapsed </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#  158.87    0.38  162.66</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">predict_svm &lt;- predict(mod_svm,newdata = testing)</span><br><span class="line">confusionMatrix(predict_svm,testing$classe)</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Confusion Matrix and Statistics</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#           Reference</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Prediction    A    B    C    D    E</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          A 1156  194  145   83   98</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          B   64  517   94   62  145</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          C   94  102  522  110  102</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          D   56   63   74  492  113</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          E   25   73   20   57  443</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Overall Statistics</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                                           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                Accuracy : 0.6383          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                  95% CI : (0.6246, 0.6517)</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     No Information Rate : 0.2845          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                                           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                   Kappa : 0.5392          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#  Mcnemar's Test P-Value : &lt; 2.2e-16       </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Statistics by Class:</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                      Class: A Class: B Class: C Class: D Class: E</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Sensitivity            0.8287   0.5448   0.6105   0.6119  0.49168</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Specificity            0.8518   0.9077   0.8992   0.9254  0.95628</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Pos Pred Value         0.6897   0.5862   0.5613   0.6165  0.71683</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Neg Pred Value         0.9260   0.8926   0.9162   0.9240  0.89314</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Prevalence             0.2845   0.1935   0.1743   0.1639  0.18373</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Detection Rate         0.2357   0.1054   0.1064   0.1003  0.09033</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Detection Prevalence   0.3418   0.1799   0.1896   0.1627  0.12602</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Balanced Accuracy      0.8402   0.7262   0.7549   0.7687  0.72398</span></span></span><br></pre></td></tr></table></figure>
<h2 id="Random-forest"><a href="#Random-forest" class="headerlink" title="Random forest"></a>Random forest</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(randomForest)</span><br><span class="line">system.time(modrf &lt;- randomForest(formula = classe ~ ., data = training))</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#    user  system elapsed </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   30.90    0.17   31.80</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">predict_rf &lt;- predict(modrf,newdata = testing)</span><br><span class="line">confusionMatrix(predict_rf,testing$classe)</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Confusion Matrix and Statistics</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#           Reference</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Prediction    A    B    C    D    E</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          A 1394    6    0    0    0</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          B    1  938    6    0    0</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          C    0    4  844   10    1</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          D    0    0    5  792    0</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          E    0    1    0    2  900</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Overall Statistics</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                                           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                Accuracy : 0.9927          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                  95% CI : (0.9899, 0.9949)</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     No Information Rate : 0.2845          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                                           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                   Kappa : 0.9907          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#  Mcnemar's Test P-Value : NA              </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Statistics by Class:</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                      Class: A Class: B Class: C Class: D Class: E</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Sensitivity            0.9993   0.9884   0.9871   0.9851   0.9989</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Specificity            0.9983   0.9982   0.9963   0.9988   0.9993</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Pos Pred Value         0.9957   0.9926   0.9825   0.9937   0.9967</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Neg Pred Value         0.9997   0.9972   0.9973   0.9971   0.9998</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Prevalence             0.2845   0.1935   0.1743   0.1639   0.1837</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Detection Rate         0.2843   0.1913   0.1721   0.1615   0.1835</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Detection Prevalence   0.2855   0.1927   0.1752   0.1625   0.1841</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Balanced Accuracy      0.9988   0.9933   0.9917   0.9919   0.9991</span></span></span><br></pre></td></tr></table></figure>
<h1 id="Model-Verification"><a href="#Model-Verification" class="headerlink" title="Model Verification"></a>Model Verification</h1><h2 id="Use-Parallel-CPU"><a href="#Use-Parallel-CPU" class="headerlink" title="Use Parallel CPU"></a>Use Parallel CPU</h2><p>Using parallel acceleration because it’s very consuming time in caret Random forest.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(parallel)</span><br><span class="line"><span class="keyword">library</span>(doParallel)</span><br><span class="line">cluster &lt;- makeCluster(detectCores() - <span class="number">1</span>) <span class="comment"># convention to leave 1 core for OS</span></span><br><span class="line">registerDoParallel(cluster)</span><br></pre></td></tr></table></figure>
<h2 id="CV-Random-forest"><a href="#CV-Random-forest" class="headerlink" title="CV Random forest"></a>CV Random forest</h2><p>Random forest with params PCA method and 2 Cross Validations</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">set.seed(<span class="number">33</span>)</span><br><span class="line">fitControl &lt;- trainControl(method = <span class="string">"cv"</span>,</span><br><span class="line">                           number = <span class="number">2</span>,</span><br><span class="line">                           classProbs = <span class="literal">T</span>,</span><br><span class="line">                           preProcOptions = c(<span class="string">"pca"</span>),</span><br><span class="line">                           verboseIter = <span class="literal">T</span>,</span><br><span class="line">                           allowParallel = <span class="literal">T</span>)</span><br><span class="line"></span><br><span class="line">system.time(mod_rf &lt;- train(classe ~ ., data = training,</span><br><span class="line">                            trControl = fitControl,</span><br><span class="line">                            preProcess = c(<span class="string">"center"</span>, <span class="string">"scale"</span>),</span><br><span class="line">                            method = <span class="string">"rf"</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Aggregating results</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Selecting tuning parameters</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Fitting mtry = 16 on full training set</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#    user  system elapsed </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   33.06    0.27  111.83</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">predict_rf &lt;- predict(mod_rf,newdata = testing)</span><br><span class="line">confusionMatrix(predict_rf,testing$classe)</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Confusion Matrix and Statistics</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#           Reference</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Prediction    A    B    C    D    E</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          A 1393    8    0    2    0</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          B    2  932    6    1    0</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          C    0    8  842   10    2</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          D    0    0    7  789    1</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          E    0    1    0    2  898</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Overall Statistics</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                                           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                Accuracy : 0.9898          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                  95% CI : (0.9866, 0.9924)</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     No Information Rate : 0.2845          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                                           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                   Kappa : 0.9871          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#  Mcnemar's Test P-Value : NA              </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Statistics by Class:</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                      Class: A Class: B Class: C Class: D Class: E</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Sensitivity            0.9986   0.9821   0.9848   0.9813   0.9967</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Specificity            0.9972   0.9977   0.9951   0.9980   0.9993</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Pos Pred Value         0.9929   0.9904   0.9768   0.9900   0.9967</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Neg Pred Value         0.9994   0.9957   0.9968   0.9963   0.9993</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Prevalence             0.2845   0.1935   0.1743   0.1639   0.1837</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Detection Rate         0.2841   0.1900   0.1717   0.1609   0.1831</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Detection Prevalence   0.2861   0.1919   0.1758   0.1625   0.1837</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Balanced Accuracy      0.9979   0.9899   0.9899   0.9897   0.9980</span></span></span><br></pre></td></tr></table></figure>
<h2 id="Final-Stop-Parallel"><a href="#Final-Stop-Parallel" class="headerlink" title="Final Stop Parallel"></a>Final Stop Parallel</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">stopCluster(cluster)</span><br><span class="line">registerDoSEQ()</span><br></pre></td></tr></table></figure>
<h2 id="Final-Result-Predict-20-Cases"><a href="#Final-Result-Predict-20-Cases" class="headerlink" title="Final Result, Predict 20 Cases"></a>Final Result, Predict 20 Cases</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(final_result &lt;- predict(modrf, testing_raw))</span><br></pre></td></tr></table></figure>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">##  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9 10 11 12</span> <span class="number">13 14 15 16</span> <span class="number">17 18 19 20</span> </span><br><span class="line">##  B  <span class="keyword">A</span>  B  <span class="keyword">A</span>  <span class="keyword">A</span>  E  D  B  <span class="keyword">A</span>  <span class="keyword">A</span>  B  C  B  <span class="keyword">A</span>  E  E  <span class="keyword">A</span>  B  B  B </span><br><span class="line">## Levels: <span class="keyword">A</span> B C D E</span><br></pre></td></tr></table></figure>
<h1 id="Conclutions"><a href="#Conclutions" class="headerlink" title="Conclutions"></a>Conclutions</h1><p>Ramdon Forest Accuracy is 0.9927 and the best fit model of this case. So we choose Ramdon Forest to predict 20 cases.</p>
<h1 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix"></a>Appendix</h1><h2 id="Training-Data-Corrplot"><a href="#Training-Data-Corrplot" class="headerlink" title="Training Data Corrplot"></a>Training Data Corrplot</h2><p><img src="courseProject_files/figure-html/unnamed-chunk-17-1.png" alt=""><!-- --><img src="courseProject_files/figure-html/unnamed-chunk-17-2.png" alt=""><!-- --></p>
<h2 id="Regression-Tree-Plot"><a href="#Regression-Tree-Plot" class="headerlink" title="Regression Tree Plot"></a>Regression Tree Plot</h2><p><img src="courseProject_files/figure-html/unnamed-chunk-18-1.png" alt=""><!-- --><img src="courseProject_files/figure-html/unnamed-chunk-18-2.png" alt=""><!-- --></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/09/courseProject/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Auto Zhao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars1.githubusercontent.com/u/7811828?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="PinkyLand">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/09/courseProject/" itemprop="url">Couse 8 Project Quantified Self Movement</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-09T00:00:00+08:00">
                2018-01-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Synopsis"><a href="#Synopsis" class="headerlink" title="Synopsis"></a>Synopsis</h1><p>One thing that people regularly do is quantify<br>how much of a particular activity they do,<br>but they rarely quantify how well they do it.<br>In this project, your goal will be to use data<br>from accelerometers on the belt, forearm, arm,<br>and dumbell of 6 participants. With Following Steps,</p>
<ul>
<li>1 fit model</li>
<li>2 cross validation</li>
<li>3 sample errors</li>
<li>4 make choices</li>
<li>5 predict 20 test case</li>
</ul>
<h1 id="Load-Data"><a href="#Load-Data" class="headerlink" title="Load Data"></a>Load Data</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(tidyverse)</span><br><span class="line"></span><br><span class="line">training_raw &lt;- read_csv(<span class="string">"pml-training.csv"</span>,na = c(<span class="string">"NA"</span>,<span class="string">"#DIV/0!"</span>,<span class="string">""</span>))</span><br><span class="line">testing_raw &lt;- read_csv(<span class="string">"pml-testing.csv"</span>,na = c(<span class="string">"NA"</span>,<span class="string">"#DIV/0!"</span>,<span class="string">""</span>))</span><br><span class="line">training_raw &lt;- as.data.frame(training_raw)</span><br><span class="line">testing_raw &lt;- as.data.frame(testing_raw)</span><br></pre></td></tr></table></figure>
<h1 id="Tidy-Data"><a href="#Tidy-Data" class="headerlink" title="Tidy Data"></a>Tidy Data</h1><p>Factorise Outcome</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">training_raw$classe &lt;- factor(training_raw$classe)</span><br></pre></td></tr></table></figure>
<p>Remove columns with more than 70% of NA or “” values</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">NArate &lt;- <span class="keyword">function</span>(x)&#123;</span><br><span class="line">    apply(x, <span class="number">2</span>, <span class="keyword">function</span>(y) sum(is.na(y)))/nrow(x)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">training_raw &lt;- training_raw[,NArate(training_raw) &lt; <span class="number">.7</span>]</span><br></pre></td></tr></table></figure>
<p>Remove near zero variances</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(caret)</span><br><span class="line">nzvCol &lt;- nearZeroVar(training_raw, saveMetrics = <span class="literal">TRUE</span>)</span><br><span class="line">training_raw &lt;- training_raw[, !nzvCol$nzv]</span><br></pre></td></tr></table></figure>
<p>Remove unused variables</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">training_raw &lt;- training_raw[,-grep(<span class="string">"name|timestamp|window|^X"</span>,names(training_raw))]</span><br></pre></td></tr></table></figure>
<p>Impute all NAs</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(mice)</span><br><span class="line">imp &lt;- mice(training_raw,seed = <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#  iter imp variable</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   1   1  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   1   2  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   1   3  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   1   4  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   1   5  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   2   1  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   2   2  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   2   3  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   2   4  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   2   5  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   3   1  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   3   2  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   3   3  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   3   4  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   3   5  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   4   1  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   4   2  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   4   3  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   4   4  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   4   5  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   5   1  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   5   2  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   5   3  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   5   4  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   5   5  magnet_dumbbell_z  magnet_forearm_y  magnet_forearm_z</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">training_raw &lt;- mice::complete(imp)</span><br></pre></td></tr></table></figure>
<p>Remove 75% highly Correlative Variables  </p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">trainingNC &lt;- training_raw[, -length(names(training_raw))]</span><br><span class="line"></span><br><span class="line">findcor &lt;- findCorrelation(cor(trainingNC,use=<span class="string">"complete.obs"</span>), cutoff = <span class="number">.75</span>)</span><br><span class="line"></span><br><span class="line">trainingFiltered &lt;- training_raw[,-findcor]</span><br><span class="line">trainingFilteredNC &lt;- trainingNC[,-findcor]</span><br></pre></td></tr></table></figure>
<h1 id="Model-Evaluation"><a href="#Model-Evaluation" class="headerlink" title="Model Evaluation"></a>Model Evaluation</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">inTrain &lt;- createDataPartition(y = trainingFiltered$classe, p = <span class="number">0.75</span>, </span><br><span class="line">                               list = <span class="literal">FALSE</span>) <span class="comment"># 75% training</span></span><br><span class="line">training &lt;- trainingFiltered[inTrain,]</span><br><span class="line">testing &lt;- trainingFiltered[-inTrain,]</span><br></pre></td></tr></table></figure>
<h2 id="Regression-Tree"><a href="#Regression-Tree" class="headerlink" title="Regression Tree"></a>Regression Tree</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(rpart)</span><br><span class="line">system.time(mod_rpart &lt;- rpart(formula = classe ~ ., data = training))</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#    user  system elapsed </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#    1.35    0.00    1.36</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">predict_rpart &lt;- predict(mod_rpart,newdata = testing,</span><br><span class="line">                         type = <span class="string">"class"</span>)</span><br><span class="line">confusionMatrix(predict_rpart,testing$classe)</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Confusion Matrix and Statistics</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#           Reference</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Prediction    A    B    C    D    E</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          A 1175  172   47   70   33</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          B   77  528  123   48  111</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          C   61  154  610  192  162</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          D   49   80   36  434   66</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          E   33   15   39   60  529</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Overall Statistics</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                                           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                Accuracy : 0.668           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                  95% CI : (0.6546, 0.6812)</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     No Information Rate : 0.2845          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                                           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                   Kappa : 0.5791          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#  Mcnemar's Test P-Value : &lt; 2.2e-16       </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Statistics by Class:</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                      Class: A Class: B Class: C Class: D Class: E</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Sensitivity            0.8423   0.5564   0.7135   0.5398   0.5871</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Specificity            0.9082   0.9092   0.8595   0.9437   0.9633</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Pos Pred Value         0.7849   0.5953   0.5174   0.6526   0.7825</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Neg Pred Value         0.9354   0.8952   0.9342   0.9127   0.9120</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Prevalence             0.2845   0.1935   0.1743   0.1639   0.1837</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Detection Rate         0.2396   0.1077   0.1244   0.0885   0.1079</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Detection Prevalence   0.3053   0.1809   0.2404   0.1356   0.1378</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Balanced Accuracy      0.8753   0.7328   0.7865   0.7417   0.7752</span></span></span><br></pre></td></tr></table></figure>
<h2 id="C50-Tree"><a href="#C50-Tree" class="headerlink" title="C50 Tree"></a>C50 Tree</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(C50)</span><br><span class="line">system.time(mod_C50 &lt;- C5.0(formula = classe ~ ., data = training))</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#    user  system elapsed </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#    2.12    0.00    2.22</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">predict_C50 &lt;- predict(mod_C50,newdata = testing)</span><br><span class="line">confusionMatrix(predict_C50,testing$classe)</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Confusion Matrix and Statistics</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#           Reference</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Prediction    A    B    C    D    E</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          A 1370   23    5    8    2</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          B   11  890   22   12   20</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          C    6   23  800   24    5</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          D    6   10   22  751    8</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          E    2    3    6    9  866</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Overall Statistics</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                                           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                Accuracy : 0.9537          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                  95% CI : (0.9475, 0.9594)</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     No Information Rate : 0.2845          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     P-Value [Acc &gt; NIR] : &lt; 2e-16         </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                                           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                   Kappa : 0.9414          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#  Mcnemar's Test P-Value : 0.06176         </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Statistics by Class:</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                      Class: A Class: B Class: C Class: D Class: E</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Sensitivity            0.9821   0.9378   0.9357   0.9341   0.9612</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Specificity            0.9892   0.9836   0.9857   0.9888   0.9950</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Pos Pred Value         0.9730   0.9319   0.9324   0.9423   0.9774</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Neg Pred Value         0.9928   0.9851   0.9864   0.9871   0.9913</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Prevalence             0.2845   0.1935   0.1743   0.1639   0.1837</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Detection Rate         0.2794   0.1815   0.1631   0.1531   0.1766</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Detection Prevalence   0.2871   0.1947   0.1750   0.1625   0.1807</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Balanced Accuracy      0.9856   0.9607   0.9607   0.9614   0.9781</span></span></span><br></pre></td></tr></table></figure>
<h2 id="SVM"><a href="#SVM" class="headerlink" title="SVM"></a>SVM</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(kernlab)</span><br><span class="line"><span class="keyword">library</span>(e1071)</span><br><span class="line">system.time(mod_svm &lt;- svm(formula = classe ~ ., data = training,</span><br><span class="line">                           kernel = <span class="string">"linear"</span>,cost = <span class="number">10</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#    user  system elapsed </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#  120.08    0.38  120.98</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">predict_svm &lt;- predict(mod_svm,newdata = testing)</span><br><span class="line">confusionMatrix(predict_svm,testing$classe)</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Confusion Matrix and Statistics</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#           Reference</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Prediction    A    B    C    D    E</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          A 1156  194  145   83   98</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          B   64  517   94   62  145</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          C   94  102  522  110  102</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          D   56   63   74  492  113</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          E   25   73   20   57  443</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Overall Statistics</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                                           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                Accuracy : 0.6383          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                  95% CI : (0.6246, 0.6517)</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     No Information Rate : 0.2845          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                                           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                   Kappa : 0.5392          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#  Mcnemar's Test P-Value : &lt; 2.2e-16       </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Statistics by Class:</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                      Class: A Class: B Class: C Class: D Class: E</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Sensitivity            0.8287   0.5448   0.6105   0.6119  0.49168</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Specificity            0.8518   0.9077   0.8992   0.9254  0.95628</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Pos Pred Value         0.6897   0.5862   0.5613   0.6165  0.71683</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Neg Pred Value         0.9260   0.8926   0.9162   0.9240  0.89314</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Prevalence             0.2845   0.1935   0.1743   0.1639  0.18373</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Detection Rate         0.2357   0.1054   0.1064   0.1003  0.09033</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Detection Prevalence   0.3418   0.1799   0.1896   0.1627  0.12602</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Balanced Accuracy      0.8402   0.7262   0.7549   0.7687  0.72398</span></span></span><br></pre></td></tr></table></figure>
<h2 id="Random-forest"><a href="#Random-forest" class="headerlink" title="Random forest"></a>Random forest</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(randomForest)</span><br><span class="line">system.time(modrf &lt;- randomForest(formula = classe ~ ., data = training))</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#    user  system elapsed </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   30.90    0.17   31.80</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">predict_rf &lt;- predict(modrf,newdata = testing)</span><br><span class="line">confusionMatrix(predict_rf,testing$classe)</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Confusion Matrix and Statistics</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#           Reference</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Prediction    A    B    C    D    E</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          A 1394    6    0    0    0</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          B    1  938    6    0    0</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          C    0    4  844   10    1</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          D    0    0    5  792    0</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          E    0    1    0    2  900</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Overall Statistics</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                                           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                Accuracy : 0.9927          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                  95% CI : (0.9899, 0.9949)</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     No Information Rate : 0.2845          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                                           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                   Kappa : 0.9907          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#  Mcnemar's Test P-Value : NA              </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Statistics by Class:</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                      Class: A Class: B Class: C Class: D Class: E</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Sensitivity            0.9993   0.9884   0.9871   0.9851   0.9989</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Specificity            0.9983   0.9982   0.9963   0.9988   0.9993</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Pos Pred Value         0.9957   0.9926   0.9825   0.9937   0.9967</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Neg Pred Value         0.9997   0.9972   0.9973   0.9971   0.9998</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Prevalence             0.2845   0.1935   0.1743   0.1639   0.1837</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Detection Rate         0.2843   0.1913   0.1721   0.1615   0.1835</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Detection Prevalence   0.2855   0.1927   0.1752   0.1625   0.1841</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Balanced Accuracy      0.9988   0.9933   0.9917   0.9919   0.9991</span></span></span><br></pre></td></tr></table></figure>
<h1 id="Model-Cross-Validation"><a href="#Model-Cross-Validation" class="headerlink" title="Model Cross Validation"></a>Model Cross Validation</h1><p>Using parallel acceleration because it’s very consuming time in caret Random forest.</p>
<h2 id="CV-Random-forest"><a href="#CV-Random-forest" class="headerlink" title="CV Random forest"></a>CV Random forest</h2><p>Use Parallel CPU</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(parallel)</span><br><span class="line"><span class="keyword">library</span>(doParallel)</span><br><span class="line">cluster &lt;- makeCluster(detectCores() - <span class="number">1</span>) <span class="comment"># convention to leave 1 core for OS</span></span><br><span class="line">registerDoParallel(cluster)</span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">set.seed(<span class="number">33</span>)</span><br><span class="line">fitControl &lt;- trainControl(method = <span class="string">"cv"</span>,</span><br><span class="line">                           number = <span class="number">2</span>,</span><br><span class="line">                           classProbs = <span class="literal">T</span>,</span><br><span class="line">                           preProcOptions = c(<span class="string">"pca"</span>),</span><br><span class="line">                           verboseIter = <span class="literal">T</span>,</span><br><span class="line">                           allowParallel = <span class="literal">T</span>)</span><br><span class="line"></span><br><span class="line">system.time(mod_rf &lt;- train(classe ~ ., data = training,</span><br><span class="line">                            trControl = fitControl,</span><br><span class="line">                            preProcess = c(<span class="string">"center"</span>, <span class="string">"scale"</span>),</span><br><span class="line">                            method = <span class="string">"rf"</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Aggregating results</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Selecting tuning parameters</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Fitting mtry = 16 on full training set</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#    user  system elapsed </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#   33.06    0.27  111.83</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">predict_rf &lt;- predict(mod_rf,newdata = testing)</span><br><span class="line"></span><br><span class="line">confusionMatrix(predict_rf,testing$classe)</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Confusion Matrix and Statistics</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#           Reference</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Prediction    A    B    C    D    E</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          A 1393    8    0    2    0</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          B    2  932    6    1    0</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          C    0    8  842   10    2</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          D    0    0    7  789    1</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#          E    0    1    0    2  898</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Overall Statistics</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                                           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                Accuracy : 0.9898          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                  95% CI : (0.9866, 0.9924)</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     No Information Rate : 0.2845          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                                           </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                   Kappa : 0.9871          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#  Mcnemar's Test P-Value : NA              </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Statistics by Class:</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#                      Class: A Class: B Class: C Class: D Class: E</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Sensitivity            0.9986   0.9821   0.9848   0.9813   0.9967</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Specificity            0.9972   0.9977   0.9951   0.9980   0.9993</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Pos Pred Value         0.9929   0.9904   0.9768   0.9900   0.9967</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Neg Pred Value         0.9994   0.9957   0.9968   0.9963   0.9993</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Prevalence             0.2845   0.1935   0.1743   0.1639   0.1837</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Detection Rate         0.2841   0.1900   0.1717   0.1609   0.1831</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Detection Prevalence   0.2861   0.1919   0.1758   0.1625   0.1837</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Balanced Accuracy      0.9979   0.9899   0.9899   0.9897   0.9980</span></span></span><br></pre></td></tr></table></figure>
<p>Stop Parallel</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">stopCluster(cluster)</span><br><span class="line">registerDoSEQ()</span><br></pre></td></tr></table></figure>
<h2 id="Final-Result-Predict-20-Cases"><a href="#Final-Result-Predict-20-Cases" class="headerlink" title="Final Result, Predict 20 Cases"></a>Final Result, Predict 20 Cases</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(final_result &lt;- predict(modrf, testing_raw))</span><br></pre></td></tr></table></figure>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">##  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9 10 11 12</span> <span class="number">13 14 15 16</span> <span class="number">17 18 19 20</span> </span><br><span class="line">##  B  <span class="keyword">A</span>  B  <span class="keyword">A</span>  <span class="keyword">A</span>  E  D  B  <span class="keyword">A</span>  <span class="keyword">A</span>  B  C  B  <span class="keyword">A</span>  E  E  <span class="keyword">A</span>  B  B  B </span><br><span class="line">## Levels: <span class="keyword">A</span> B C D E</span><br></pre></td></tr></table></figure>
<h1 id="Conclutions"><a href="#Conclutions" class="headerlink" title="Conclutions"></a>Conclutions</h1><p>Ramdon Forest Accuracy is 0.9927 and the best fit model of this case. So we choose Ramdon Forest to predict 20 cases.</p>
<h1 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix"></a>Appendix</h1><p>Training Data Corrplot </p>
<p><img src="courseProject_files/figure-html/unnamed-chunk-17-1.png" alt=""><!-- --><img src="courseProject_files/figure-html/unnamed-chunk-17-2.png" alt=""><!-- --></p>
<p>Regression Tree Plot</p>
<p><img src="courseProject_files/figure-html/unnamed-chunk-18-1.png" alt=""><!-- --><img src="courseProject_files/figure-html/unnamed-chunk-18-2.png" alt=""><!-- --></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="https://avatars1.githubusercontent.com/u/7811828?s=460&v=4"
                alt="Auto Zhao" />
            
              <p class="site-author-name" itemprop="name">Auto Zhao</p>
              <p class="site-description motion-element" itemprop="description">A Place for Learning</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/autolordz" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:autolordz@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Auto Zhao</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count"></span>
  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.4"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.4"></script>


  

</body>
</html>
