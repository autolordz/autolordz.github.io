<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="A Place for Learning">
<meta property="og:type" content="website">
<meta property="og:title" content="PinkyLand">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="PinkyLand">
<meta property="og:description" content="A Place for Learning">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PinkyLand">
<meta name="twitter:description" content="A Place for Learning">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":true,"scrollpercent":true,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>PinkyLand</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">PinkyLand</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">PinkyLand Always</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            Sitemap
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/12/My-1st-New-Post/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Auto Zhao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars1.githubusercontent.com/u/7811828?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="PinkyLand">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/12/My-1st-New-Post/" itemprop="url">Course 8 Project Quantified Self Movement</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-12T18:09:06+08:00">
                2018-02-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Assign-2018-1-9"><a href="#Assign-2018-1-9" class="headerlink" title="Assign:2018.1.9"></a>Assign:2018.1.9</h1><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>One thing that people regularly do is quantify how much of a particular activity they do, but they rarely quantify how well they do it. In this project, your goal will be to use data from accelerometers on the belt, forearm, arm, and dumbell of 6 participants. With Following Steps,</p>
<p><code>1 fit model</code><br><code>2 cross validation</code><br><code>3 sample errors</code><br><code>4 make choices</code><br><code>5 predict 20 test case</code></p>
<h1 id="Load-Data"><a href="#Load-Data" class="headerlink" title="Load Data"></a>Load Data</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(tidyverse)</span><br><span class="line">training_raw &lt;- read_csv(<span class="string">"pml-training.csv"</span>,na = c(<span class="string">"NA"</span>,<span class="string">"#DIV/0!"</span>,<span class="string">""</span>))</span><br><span class="line">testing_raw &lt;- read_csv(<span class="string">"pml-testing.csv"</span>,na = c(<span class="string">"NA"</span>,<span class="string">"#DIV/0!"</span>,<span class="string">""</span>))</span><br><span class="line">training_raw &lt;- as.data.frame(training_raw)</span><br><span class="line">testing_raw &lt;- as.data.frame(testing_raw)</span><br></pre></td></tr></table></figure>
<h1 id="Cleaning-the-Training-Data"><a href="#Cleaning-the-Training-Data" class="headerlink" title="Cleaning the Training Data"></a>Cleaning the Training Data</h1><!-- Clean Data -->
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">training_raw$classe &lt;- factor(training_raw$classe)</span><br></pre></td></tr></table></figure>
<h1 id="Remove-columns-with-more-than-70-of-NA-or-“”-values"><a href="#Remove-columns-with-more-than-70-of-NA-or-“”-values" class="headerlink" title="Remove columns with more than 70% of NA or “” values"></a>Remove columns with more than 70% of NA or “” values</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">NArate &lt;- <span class="keyword">function</span>(x)&#123;</span><br><span class="line">    apply(x, <span class="number">2</span>, <span class="keyword">function</span>(y) sum(is.na(y)))/nrow(x)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">training_raw &lt;- training_raw[,NArate(training_raw) &lt; <span class="number">.7</span>]</span><br></pre></td></tr></table></figure>
<h1 id="Remove-near-zero-variances"><a href="#Remove-near-zero-variances" class="headerlink" title="Remove near zero variances"></a>Remove near zero variances</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(caret)</span><br><span class="line">nzvCol &lt;- nearZeroVar(training_raw, saveMetrics = <span class="literal">TRUE</span>)</span><br><span class="line">training_raw &lt;- training_raw[, !nzvCol$nzv]</span><br></pre></td></tr></table></figure>
<h1 id="Remove-unused-variables"><a href="#Remove-unused-variables" class="headerlink" title="Remove unused variables"></a>Remove unused variables</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">training_raw &lt;- training_raw[,-grep(<span class="string">"name|timestamp|window|^X"</span>,names(training_raw))]</span><br></pre></td></tr></table></figure>
<h1 id="Impute-all-NAs"><a href="#Impute-all-NAs" class="headerlink" title="Impute all NAs"></a>Impute all NAs</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(mice)</span><br><span class="line">imp &lt;- mice(training_raw,seed = <span class="number">3</span>)</span><br><span class="line">training_raw &lt;- mice::complete(imp)</span><br></pre></td></tr></table></figure>
<h1 id="Remove-75-highly-Correlative-Variables"><a href="#Remove-75-highly-Correlative-Variables" class="headerlink" title="Remove 75% highly Correlative Variables"></a>Remove 75% highly Correlative Variables</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">trainingNC &lt;- training_raw[, -length(names(training_raw))]</span><br><span class="line">findcor &lt;- findCorrelation(cor(trainingNC,use=<span class="string">"complete.obs"</span>), cutoff = <span class="number">.75</span>)</span><br><span class="line">trainingFiltered &lt;- training_raw[,-findcor]</span><br><span class="line">trainingFilteredNC &lt;- trainingNC[,-findcor]</span><br></pre></td></tr></table></figure>
<!-- Clean Data End -->
<h1 id="Cross-validation"><a href="#Cross-validation" class="headerlink" title="Cross validation"></a>Cross validation</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">inTrain &lt;- createDataPartition(y = trainingFiltered$classe, p = <span class="number">0.75</span>, </span><br><span class="line">                               list = <span class="literal">FALSE</span>) <span class="comment"># 75% training</span></span><br><span class="line">training &lt;- trainingFiltered[inTrain,]</span><br><span class="line">testing &lt;- trainingFiltered[-inTrain,]</span><br></pre></td></tr></table></figure>
<h1 id="Model-Evaluation"><a href="#Model-Evaluation" class="headerlink" title="Model Evaluation"></a>Model Evaluation</h1><h1 id="Regression-Tree"><a href="#Regression-Tree" class="headerlink" title="Regression Tree"></a>Regression Tree</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(rpart)</span><br><span class="line">system.time(mod_rpart &lt;- rpart(formula = classe ~ ., data = training))</span><br></pre></td></tr></table></figure>
<pre><code>##    user  system elapsed 
##     1.3     0.0     1.3
</code></pre><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">predict_rpart &lt;- predict(mod_rpart,newdata = testing,</span><br><span class="line">                         type = <span class="string">"class"</span>)</span><br><span class="line">confusionMatrix(predict_rpart,testing$classe)</span><br></pre></td></tr></table></figure>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 1175  172   47   70   33
##          B   77  528  123   48  111
##          C   61  154  610  192  162
##          D   49   80   36  434   66
##          E   33   15   39   60  529
## 
## Overall Statistics
##                                           
##                Accuracy : 0.668           
##                  95% CI : (0.6546, 0.6812)
##     No Information Rate : 0.2845          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.5791          
##  Mcnemar&apos;s Test P-Value : &lt; 2.2e-16       
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            0.8423   0.5564   0.7135   0.5398   0.5871
## Specificity            0.9082   0.9092   0.8595   0.9437   0.9633
## Pos Pred Value         0.7849   0.5953   0.5174   0.6526   0.7825
## Neg Pred Value         0.9354   0.8952   0.9342   0.9127   0.9120
## Prevalence             0.2845   0.1935   0.1743   0.1639   0.1837
## Detection Rate         0.2396   0.1077   0.1244   0.0885   0.1079
## Detection Prevalence   0.3053   0.1809   0.2404   0.1356   0.1378
## Balanced Accuracy      0.8753   0.7328   0.7865   0.7417   0.7752
</code></pre><h1 id="C50-Tree"><a href="#C50-Tree" class="headerlink" title="C50 Tree"></a>C50 Tree</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(C50)</span><br><span class="line">system.time(mod_C50 &lt;- C5.0(formula = classe ~ ., data = training))</span><br></pre></td></tr></table></figure>
<pre><code>##    user  system elapsed 
##    1.93    0.00    1.92
</code></pre><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">predict_C50 &lt;- predict(mod_C50,newdata = testing)</span><br><span class="line">confusionMatrix(predict_C50,testing$classe)</span><br></pre></td></tr></table></figure>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 1370   23    5    8    2
##          B   11  890   22   12   20
##          C    6   23  800   24    5
##          D    6   10   22  751    8
##          E    2    3    6    9  866
## 
## Overall Statistics
##                                           
##                Accuracy : 0.9537          
##                  95% CI : (0.9475, 0.9594)
##     No Information Rate : 0.2845          
##     P-Value [Acc &gt; NIR] : &lt; 2e-16         
##                                           
##                   Kappa : 0.9414          
##  Mcnemar&apos;s Test P-Value : 0.06176         
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            0.9821   0.9378   0.9357   0.9341   0.9612
## Specificity            0.9892   0.9836   0.9857   0.9888   0.9950
## Pos Pred Value         0.9730   0.9319   0.9324   0.9423   0.9774
## Neg Pred Value         0.9928   0.9851   0.9864   0.9871   0.9913
## Prevalence             0.2845   0.1935   0.1743   0.1639   0.1837
## Detection Rate         0.2794   0.1815   0.1631   0.1531   0.1766
## Detection Prevalence   0.2871   0.1947   0.1750   0.1625   0.1807
## Balanced Accuracy      0.9856   0.9607   0.9607   0.9614   0.9781
</code></pre><h1 id="SVM"><a href="#SVM" class="headerlink" title="SVM"></a>SVM</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(kernlab)</span><br></pre></td></tr></table></figure>
<pre><code>## 
## Attaching package: &apos;kernlab&apos;

## The following object is masked from &apos;package:purrr&apos;:
## 
##     cross

## The following object is masked from &apos;package:ggplot2&apos;:
## 
##     alpha
</code></pre><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(e1071)</span><br><span class="line">system.time(mod_svm &lt;- svm(formula = classe ~ ., data = training,</span><br><span class="line">                           kernel = <span class="string">"linear"</span>,cost = <span class="number">10</span>))</span><br></pre></td></tr></table></figure>
<pre><code>##    user  system elapsed 
##  125.33    0.52  128.12
</code></pre><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">predict_svm &lt;- predict(mod_svm,newdata = testing)</span><br><span class="line">confusionMatrix(predict_svm,testing$classe)</span><br></pre></td></tr></table></figure>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 1156  194  145   83   98
##          B   64  517   94   62  145
##          C   94  102  522  110  102
##          D   56   63   74  492  113
##          E   25   73   20   57  443
## 
## Overall Statistics
##                                           
##                Accuracy : 0.6383          
##                  95% CI : (0.6246, 0.6517)
##     No Information Rate : 0.2845          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.5392          
##  Mcnemar&apos;s Test P-Value : &lt; 2.2e-16       
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            0.8287   0.5448   0.6105   0.6119  0.49168
## Specificity            0.8518   0.9077   0.8992   0.9254  0.95628
## Pos Pred Value         0.6897   0.5862   0.5613   0.6165  0.71683
## Neg Pred Value         0.9260   0.8926   0.9162   0.9240  0.89314
## Prevalence             0.2845   0.1935   0.1743   0.1639  0.18373
## Detection Rate         0.2357   0.1054   0.1064   0.1003  0.09033
## Detection Prevalence   0.3418   0.1799   0.1896   0.1627  0.12602
## Balanced Accuracy      0.8402   0.7262   0.7549   0.7687  0.72398
</code></pre><h1 id="Random-forest"><a href="#Random-forest" class="headerlink" title="Random forest"></a>Random forest</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(randomForest)</span><br><span class="line">system.time(modrf &lt;- randomForest(formula = classe ~ ., data = training))</span><br></pre></td></tr></table></figure>
<pre><code>##    user  system elapsed 
##   25.22    0.15   26.19
</code></pre><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">predict_rf &lt;- predict(modrf,newdata = testing)</span><br><span class="line">confusionMatrix(predict_rf,testing$classe)</span><br></pre></td></tr></table></figure>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 1394    6    0    0    0
##          B    1  938    6    0    0
##          C    0    4  844   10    1
##          D    0    0    5  792    0
##          E    0    1    0    2  900
## 
## Overall Statistics
##                                           
##                Accuracy : 0.9927          
##                  95% CI : (0.9899, 0.9949)
##     No Information Rate : 0.2845          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.9907          
##  Mcnemar&apos;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            0.9993   0.9884   0.9871   0.9851   0.9989
## Specificity            0.9983   0.9982   0.9963   0.9988   0.9993
## Pos Pred Value         0.9957   0.9926   0.9825   0.9937   0.9967
## Neg Pred Value         0.9997   0.9972   0.9973   0.9971   0.9998
## Prevalence             0.2845   0.1935   0.1743   0.1639   0.1837
## Detection Rate         0.2843   0.1913   0.1721   0.1615   0.1835
## Detection Prevalence   0.2855   0.1927   0.1752   0.1625   0.1841
## Balanced Accuracy      0.9988   0.9933   0.9917   0.9919   0.9991
</code></pre><h1 id="Model-verification"><a href="#Model-verification" class="headerlink" title="Model verification"></a>Model verification</h1><p>Using parallel acceleration because it’s very consuming time in caret Random forest.</p>
<h1 id="Use-Parallel-CPU"><a href="#Use-Parallel-CPU" class="headerlink" title="Use Parallel CPU"></a>Use Parallel CPU</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(parallel)</span><br><span class="line"><span class="keyword">library</span>(doParallel)</span><br><span class="line">cluster &lt;- makeCluster(detectCores() - <span class="number">1</span>) <span class="comment"># convention to leave 1 core for OS</span></span><br><span class="line">registerDoParallel(cluster)</span><br></pre></td></tr></table></figure>
<h1 id="CV-Random-forest"><a href="#CV-Random-forest" class="headerlink" title="CV Random forest"></a>CV Random forest</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">set.seed(<span class="number">33</span>)</span><br><span class="line">fitControl &lt;- trainControl(method = <span class="string">"cv"</span>,</span><br><span class="line">                           number = <span class="number">2</span>,</span><br><span class="line">                           classProbs = <span class="literal">T</span>,</span><br><span class="line">                           preProcOptions = c(<span class="string">"pca"</span>),</span><br><span class="line">                           verboseIter = <span class="literal">T</span>,</span><br><span class="line">                           allowParallel = <span class="literal">T</span>)</span><br><span class="line"></span><br><span class="line">system.time(mod_rf &lt;- train(classe ~ ., data = training,</span><br><span class="line">                            trControl = fitControl,</span><br><span class="line">                            preProcess = c(<span class="string">"center"</span>, <span class="string">"scale"</span>),</span><br><span class="line">                            method = <span class="string">"rf"</span>))</span><br></pre></td></tr></table></figure>
<pre><code>## Aggregating results
## Selecting tuning parameters
## Fitting mtry = 16 on full training set

##    user  system elapsed 
##   28.99    0.25   82.44
</code></pre><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">predict_rf &lt;- predict(mod_rf,newdata = testing)</span><br><span class="line"></span><br><span class="line">confusionMatrix(predict_rf,testing$classe)</span><br></pre></td></tr></table></figure>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 1393    8    0    2    0
##          B    2  932    6    1    0
##          C    0    8  842   10    2
##          D    0    0    7  789    1
##          E    0    1    0    2  898
## 
## Overall Statistics
##                                           
##                Accuracy : 0.9898          
##                  95% CI : (0.9866, 0.9924)
##     No Information Rate : 0.2845          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.9871          
##  Mcnemar&apos;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            0.9986   0.9821   0.9848   0.9813   0.9967
## Specificity            0.9972   0.9977   0.9951   0.9980   0.9993
## Pos Pred Value         0.9929   0.9904   0.9768   0.9900   0.9967
## Neg Pred Value         0.9994   0.9957   0.9968   0.9963   0.9993
## Prevalence             0.2845   0.1935   0.1743   0.1639   0.1837
## Detection Rate         0.2841   0.1900   0.1717   0.1609   0.1831
## Detection Prevalence   0.2861   0.1919   0.1758   0.1625   0.1837
## Balanced Accuracy      0.9979   0.9899   0.9899   0.9897   0.9980
</code></pre><h1 id="Stop-Parallel"><a href="#Stop-Parallel" class="headerlink" title="Stop Parallel"></a>Stop Parallel</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">stopCluster(cluster)</span><br><span class="line">registerDoSEQ()</span><br></pre></td></tr></table></figure>
<h1 id="Final-Result-Predict-20-Cases"><a href="#Final-Result-Predict-20-Cases" class="headerlink" title="Final Result, Predict 20 Cases"></a>Final Result, Predict 20 Cases</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(final_result &lt;- predict(modrf, testing_raw))</span><br></pre></td></tr></table></figure>
<pre><code>##  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 
##  B  A  B  A  A  E  D  B  A  A  B  C  B  A  E  E  A  B  B  B 
## Levels: A B C D E
</code></pre><h1 id="Conclutions"><a href="#Conclutions" class="headerlink" title="Conclutions"></a>Conclutions</h1><p>Ramdon Forest Accuracy is 0.9927 and the best fit model of this case. So we choose Ramdon Forest to predict 20 cases.</p>
<h1 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix"></a>Appendix</h1><h1 id="Training-Data-Corrplot"><a href="#Training-Data-Corrplot" class="headerlink" title="Training Data Corrplot"></a>Training Data Corrplot</h1><p><img src="/courseProject_files/figure-markdown_github/unnamed-chunk-17-1.png" alt=""><img src="/courseProject_files/figure-markdown_github/unnamed-chunk-17-2.png" alt=""></p>
<h1 id="Regression-Tree-Plot"><a href="#Regression-Tree-Plot" class="headerlink" title="Regression Tree Plot"></a>Regression Tree Plot</h1><p><img src="/courseProject_files/figure-markdown_github/unnamed-chunk-18-1.png" alt=""><img src="/courseProject_files/figure-markdown_github/unnamed-chunk-18-2.png" alt=""></p>
<p><img src="/images/favicon-32x32-next.png" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/12/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Auto Zhao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars1.githubusercontent.com/u/7811828?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="PinkyLand">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/12/hello-world/" itemprop="url">Hello World</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-12T17:50:15+08:00">
                2018-02-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="https://avatars1.githubusercontent.com/u/7811828?s=460&v=4"
                alt="Auto Zhao" />
            
              <p class="site-author-name" itemprop="name">Auto Zhao</p>
              <p class="site-description motion-element" itemprop="description">A Place for Learning</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/autolordz" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:autolordz@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Auto Zhao</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count"></span>
  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.4"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.4"></script>


  

</body>
</html>
